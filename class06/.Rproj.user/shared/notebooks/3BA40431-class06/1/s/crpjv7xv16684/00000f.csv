"0","# define scoring funcs"
"0",""
"0","grade_student <- function(scores){"
"0","  # check for NA"
"0","  na_count <- sum(is.na(scores))"
"0","  "
"0","  # if no NA, drop lowest"
"0","  if (sum(is.na(scores)) == 0) {"
"0","    top_scores = scores[scores != min(scores)]"
"0","  }"
"0","  "
"0","  # if one NA, drop it"
"0","  else if (na_count == 1) {"
"0","    top_scores = scores[!is.na(scores)]"
"0","  }"
"0","  "
"0","  # if multiple NA, drop first"
"0","  else {"
"0","    top_scores = scores[-(which(is.na(scores))[1])]"
"0","  }"
"0","  "
"0","  # set remaining NAs to 0"
"0","  top_scores[is.na(top_scores)] <- 0"
"0","    "
"0","  # compute mean score"
"0","  overall_grade = mean(top_scores)"
"0","    "
"0","  return(overall_grade)"
"0","}"
"0",""
"0","# create wrapper function for table"
"0","grade <- function(table){"
"0","  apply(table[, sapply(table, is.numeric)], 1, grade_student)"
"0","}"
"0",""
