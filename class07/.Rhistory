x_long
# Create grouped bar plot
library(ggplot2)
ggplot(x_long) +
aes(x = Country, y = Consumption, fill = Food) +
geom_col(position = "dodge") +
theme_bw()
# plot stacked
ggplot(x_long) +
aes(x = Country, y = Consumption, fill = Food) +
geom_col() +
theme_bw()
pairs(x, col=rainbow(nrow(x)), pch=16)
library(pheatmap)
install.packages(pheatmap)
install.packages(pheatmap)
install.packages("pheatmap")
library(pheatmap)
pheatmap( as.matrix(x) )
pca <- prcomp( t(x) )
summary(pca)
hclust(data)
# compute distances between points
dist(data)
hclust(dist(data))
# run hierarchical clustering
hx <- hclust(dist(data))
hc
# run hierarchical clustering
hc <- hclust(dist(data))
hc
# plot results
plot(hc)
# import data
url <- "https://tinyurl.com/UK-foods"
x <- read.csv(url)
# print size and data
print(dim(x))
x
# reformat table
rownames(x) <- x[,1]
x <- x[,-1]
head(x)
x <- read.csv(url, row.names=1)
x
# plot bar chart with basic plotting functionality
barplot(as.matrix(x), beside=T, col=rainbow(nrow(x)))
# repeat with `beside=F`
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
library(tidyr)
# Convert data to long format for ggplot with `pivot_longer()`
x_long <- x |>
tibble::rownames_to_column("Food") |>
pivot_longer(cols = -Food,
names_to = "Country",
values_to = "Consumption")
print(dim(x_long))
x_long
# Create grouped bar plot
library(ggplot2)
ggplot(x_long) +
aes(x = Country, y = Consumption, fill = Food) +
geom_col(position = "dodge") +
theme_bw()
# plot stacked
ggplot(x_long) +
aes(x = Country, y = Consumption, fill = Food) +
geom_col() +
theme_bw()
pairs(x, col=rainbow(nrow(x)), pch=16)
install.packages("pheatmap")
library(pheatmap)
pheatmap( as.matrix(x) )
pca <- prcomp( t(x) )
summary(pca)
install.packages("pheatmap")
# Create a data frame for plotting
df <- as.data.frame(pca$x)
df$Country <- rownames(df)
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = ___, y = ___, label = rownames(pca$x)) +
# Create a data frame for plotting
df <- as.data.frame(pca$x)
df$Country <- rownames(df)
df
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# plot results
plot(hc)
obline(h=7, col='red')
cuttree(hc, h=7)
cutree(hc, h=7)
grps <- cutree(hc, h=7)
grps
plot(data, col=grps)
# plot results
plot(hc)
abline(h=7, col='red')
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x), col=[1,2,3,4]) +
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x), col=(1,2,3,4) +
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x), col=(1:4)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
scale_color_manual
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5, scale_color_manual()) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw() +
scale_color_manual()
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw() +
scale_color_manual()
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw() +
scale_color_manual(Country)
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw() +
scale_color_manual("Country")
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw() +
scale_color_manual(df$Country)
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw() +
scale_color_manual(values=df$Country)
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw() +
scale_color_manual(values = c("red", "yellow", "blue", "green"))
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw() +
scale_color_manual(values = c("red", "yellow", "blue", "green"))
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5, scale_color_manual(values = c("red", "yellow", "blue", "green"))) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5, scale_color_manual(values = c("red", "yellow", "blue", "green")) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5, scale_color_manual(values = c("red", "yellow", "blue", "green"))) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5, colors=("red", "yellow", "blue", "green") +
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5, colors=c("red", "yellow", "blue", "green") +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5, colors=c("red", "yellow", "blue", "green")) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5, colours=c("red", "yellow", "blue", "green")) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5, col=c("red", "yellow", "blue", "green")) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5, col=c( "yellow", "red", "blue", "green")) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5, col=c( "yellow", "red", "blue", "green")) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# import data
url <- "https://tinyurl.com/UK-foods"
x <- read.csv(url)
# import data
url <- "https://tinyurl.com/UK-foods"
x <- read.csv(url)
# print size and data
print(dim(x))
x
# reformat table
rownames(x) <- x[,1]
x <- x[,-1]
head(x)
x <- read.csv(url, row.names=1)
x
# plot bar chart with basic plotting functionality
barplot(as.matrix(x), beside=T, col=rainbow(nrow(x)))
# repeat with `beside=F`
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
library(tidyr)
# Convert data to long format for ggplot with `pivot_longer()`
x_long <- x |>
tibble::rownames_to_column("Food") |>
pivot_longer(cols = -Food,
names_to = "Country",
values_to = "Consumption")
print(dim(x_long))
x_long
# Create grouped bar plot
library(ggplot2)
ggplot(x_long) +
aes(x = Country, y = Consumption, fill = Food) +
geom_col(position = "dodge") +
theme_bw()
# plot stacked
ggplot(x_long) +
aes(x = Country, y = Consumption, fill = Food) +
geom_col() +
theme_bw()
pairs(x, col=rainbow(nrow(x)), pch=16)
# install.packages("pheatmap")
library(pheatmap)
pheatmap( as.matrix(x) )
pca <- prcomp( t(x) )
summary(pca)
# Create a data frame for plotting
df <- as.data.frame(pca$x)
df$Country <- rownames(df)
df
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# Plot PC1 vs PC2 with ggplot
ggplot(pca$x) +
aes(x = PC1, y = PC2, label = rownames(pca$x)) +
geom_point(size = 3) +
geom_text(vjust = -0.5, col=c( "yellow", "red", "blue", "green")) +
xlim(-270, 500) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
v <- round( pca$sdev^2/sum(pca$sdev^2) * 100 )
V
v <- round( pca$sdev^2/sum(pca$sdev^2) * 100 )
V
v <- round( pca$sdev^2/sum(pca$sdev^2) * 100 )
V
v <- round( pca$sdev^2/sum(pca$sdev^2) * 100 )
V
v <- round( pca$sdev^2/sum(pca$sdev^2) * 100 )
V
v <- round( pca$sdev^2/sum(pca$sdev^2) * 100 )
V
v <- round( pca$sdev^2/sum(pca$sdev^2) * 100 )
v
z <- summary(pca)
z$importance
# Create scree plot with ggplot
variance_df <- data.frame(
PC = factor(paste0("PC", 1:length(v)), levels = paste0("PC", 1:length(v))),
Variance = v
)
ggplot(variance_df) +
aes(x = PC, y = Variance) +
geom_col(fill = "steelblue") +
xlab("Principal Component") +
ylab("Percent Variation") +
theme_bw() +
theme(axis.text.x = element_text(angle = 0))
?factor
```{r}
?paste0
```{r}
?paste0
ggplot(pca$rotation) +
aes(x = PC1,
y = reorder(rownames(pca$rotation), PC1)) +
geom_col(fill = "steelblue") +
xlab("PC1 Loading Score") +
ylab("") +
theme_bw() +
theme(axis.text.y = element_text(size = 9))
ggplot(pca$rotation) +
aes(x = PC2,
y = reorder(rownames(pca$rotation), PC1)) +
geom_col(fill = "steelblue") +
xlab("PC2 Loading Score") +
ylab("") +
theme_bw() +
theme(axis.text.y = element_text(size = 9))
ggplot(pca$rotation) +
aes(x = PC2,
y = reorder(rownames(pca$rotation), PC1)) +
geom_col(fill = "steelblue") +
xlab("PC2 Loading Score") +
ylab("") +
theme_bw() +
theme(axis.text.y = element_text(size = 9))
url2 <- "https://tinyurl.com/expression-CSV"
rna.data <- read.csv(url2, row.names=1)
url2 <- "https://tinyurl.com/expression-CSV"
rna.data <- read.csv(url2, row.names=1)
head(rna.data)
# run PCA and plot results
pca <- prcomp(t(rna.data), scale=TRUE)
# Create data frame for plotting
df <- as.data.frame(pca$x)
df$Sample <- rownames(df)
## Plot with ggplot
ggplot(df) +
aes(x = PC1, y = PC2, label = Sample) +
geom_point(size = 3) +
geom_text(vjust = -0.5, size = 3) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
# run PCA and plot results
pca <- prcomp(t(rna.data), scale=TRUE)
# Create data frame for plotting
df <- as.data.frame(pca$x)
df$Sample <- rownames(df)
## Plot with ggplot
ggplot(df) +
aes(x = PC1, y = PC2, label = Sample) +
geom_point(size = 3) +
geom_text(vjust = -0.5, size = 3) +
xlab("PC1") +
ylab("PC2") +
theme_bw()
summary(pca)
# Calculate variance explained
pca.var <- pca$sdev^2
pca.var.per <- round(pca.var/sum(pca.var)*100, 1)
# Create scree plot data
scree_df <- data.frame(
PC = factor(paste0("PC", 1:10), levels = paste0("PC", 1:10)),
Variance = pca.var[1:10]
)
ggplot(scree_df) +
aes(x = PC, y = Variance) +
geom_col(fill = "steelblue") +
ggtitle("Quick scree plot") +
xlab("Principal Component") +
ylab("Variance") +
theme_bw()
# Create percent variance scree plot
scree_pct_df <- data.frame(
PC = factor(paste0("PC", 1:10), levels = paste0("PC", 1:10)),
PercentVariation = pca.var.per[1:10]
)
ggplot(scree_pct_df) +
aes(x = PC, y = PercentVariation) +
geom_col(fill = "steelblue") +
ggtitle("Scree Plot") +
xlab("Principal Component") +
ylab("Percent Variation") +
theme_bw()
ggplot(df) +
aes(x = PC1, y = PC2, color = color, label = Sample) +
geom_point(size = 3) +
geom_text(vjust = -0.5, hjust = 0.5, show.legend = FALSE) +
scale_color_identity() +
xlab(paste0("PC1 (", pca.var.per[1], "%)")) +
ylab(paste0("PC2 (", pca.var.per[2], "%)")) +
theme_bw()
#re-plot PCA results with colors based on grouping
colvec <- colnames(rna.data)
colvec[grep("wt", colvec)] <- "red"
colvec[grep("ko", colvec)] <- "blue"
# Add condition to data frame
df$condition <- substr(df$Sample, 1, 2)
df$color <- colvec
ggplot(df) +
aes(x = PC1, y = PC2, color = color, label = Sample) +
geom_point(size = 3) +
geom_text(vjust = -0.5, hjust = 0.5, show.legend = FALSE) +
scale_color_identity() +
xlab(paste0("PC1 (", pca.var.per[1], "%)")) +
ylab(paste0("PC2 (", pca.var.per[2], "%)")) +
theme_bw()
# check out loading scores
loading_scores <- pca$rotation[,1]
## Find the top 10 measurements (genes) that contribute
## most to PC1 in either direction (+ or -)
gene_scores <- abs(loading_scores)
gene_score_ranked <- sort(gene_scores, decreasing=TRUE)
## show the names of the top 10 genes
top_10_genes <- names(gene_score_ranked[1:10])
top_10_genes
