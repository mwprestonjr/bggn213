"0","# Calculate variance explained"
"0","pca.var <- pca$sdev^2"
"0","pca.var.per <- round(pca.var/sum(pca.var)*100, 1)"
"0",""
"0","# Create scree plot data"
"0","scree_df <- data.frame("
"0","  PC = factor(paste0(""PC"", 1:10), levels = paste0(""PC"", 1:10)),"
"0","  Variance = pca.var[1:10]"
"0",")"
"0",""
"0","ggplot(scree_df) +"
"0","  aes(x = PC, y = Variance) +"
"0","  geom_col(fill = ""steelblue"") +"
"0","  ggtitle(""Quick scree plot"") +"
"0","  xlab(""Principal Component"") +"
"0","  ylab(""Variance"") +"
"0","  theme_bw()"
