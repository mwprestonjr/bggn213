# import with basic function
data <- read.csv("Data Export Summary.csv")
head(data)
# import data with readr package
library(readr)
stats <- read_csv("Data Export Summary.csv")
head(stats)
# plot barchart of molecular types
library(ggplot2)
ggplot(stats) +
aes(reorder(`Molecular Type`, -Total), Total) +
geom_col() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
xlab("Molecular Type")
stats[stats$`Molecular Type`=="Protein (only)", "Total"] / sum(stats$Total)
library(bio3d)
aa <- get.seq("1ake_A")
library(bio3d)
aa <- get.seq("1ake_A")
aa
aa
View(aa)
aa$ali
aa$ali |> length()
# Blast search
b <- blast.pdb(aa)
# Blast search
#b <- blast.pdb(aa)
# Plot a summary of search results
#hits <- plot(b)
# List out some 'top hits'
#head(hits$pdb.id)
hits <- NULL
hits$pdb.id <- c('1AKE_A','6S36_A','6RZE_A','3HPR_A','1E4V_A','5EJE_A','1E4Y_A','3X2S_A','6HAP_A','6HAM_A','4K46_A','3GMT_A','4PZL_A')
# Download related PDB files
files <- get.pdb(hits$pdb.id, path="pdbs", split=TRUE, gzip=TRUE)
# Align related PDBs
pdbs <- pdbaln(files, fit = TRUE, exefile="msa")
install.packages("devtools")
install.packages("BiocManager")
BiocManager::install("msa")
devtools::install_bitbucket("Grantlab/bio3d-view")
# Align related PDBs
pdbs <- pdbaln(files, fit = TRUE, exefile="msa")
hits <- NULL
hits$pdb.id <- c('1AKE_A','6S36_A','6RZE_A','3HPR_A','1E4V_A','5EJE_A','1E4Y_A','3X2S_A','6HAP_A','6HAM_A','4K46_A','3GMT_A','4PZL_A')
# Download related PDB files
files <- get.pdb(hits$pdb.id, path="pdbs", split=TRUE, gzip=TRUE)
# Download related PDB files
files <- get.pdb(hits$pdb.id, path="pdbs", split=TRUE, gzip=TRUE)
hits <- NULL
hits$pdb.id <- c('1AKE_A','6S36_A','6RZE_A','3HPR_A','1E4V_A','5EJE_A','1E4Y_A','3X2S_A','6HAP_A','6HAM_A','4K46_A','3GMT_A','4PZL_A')
# Download related PDB files
files <- get.pdb(hits$pdb.id, path="pdbs", split=TRUE, gzip=TRUE)
library(bio3d)
aa <- get.seq("1ake_A")
aa
# Download related PDB files
files <- get.pdb(hits$pdb.id, path="pdbs", split=TRUE, gzip=TRUE)
# Align related PDBs
pdbs <- pdbaln(files, fit = TRUE, exefile="msa")
# Vector containing PDB codes for figure axis
ids <- basename.pdb(pdbs$id)
# Draw schematic alignment
plot(pdbs, labels=ids)
# Vector containing PDB codes for figure axis
ids <- basename.pdb(pdbs$id)
# Draw schematic alignment
plot(pdbs, labels=ids)
# Vector containing PDB codes for figure axis
ids <- basename.pdb(pdbs$id)
# Draw schematic alignment
plot(pdbs, labels=ids)
# Vector containing PDB codes for figure axis
ids <- basename.pdb(pdbs$id)
# Draw schematic alignment
plot(pdbs, labels=ids)
# Vector containing PDB codes for figure axis
ids <- basename.pdb(pdbs$id)
# Draw schematic alignment
plot(pdbs, labels=ids)
anno <- pdb.annotate(ids)
unique(anno$source)
anno
# Perform PCA
pc.xray <- pca(pdbs)
plot(pc.xray)
View(pc.xray)
View(pdbs)
View(pdbs)
# Calculate RMSD
rd <- rmsd(pdbs)
# Structure-based clustering
hc.rd <- hclust(dist(rd))
grps.rd <- cutree(hc.rd, k=3)
plot(pc.xray, 1:2, col="grey50", bg=grps.rd, pch=21, cex=1)
# NMA of all structures
modes <- nma(pdbs)
plot(modes, pdbs, col=grps.rd)
# NMA of all structures
modes <- nma(pdbs)
plot(modes, pdbs, col=grps.rd)
head(anno)
# Plot a summary of search results
hits <- plot(b)
library(bio3d)
aa <- get.seq("1ake_A")
aa
# Blast search
b <- blast.pdb(aa)
hits <- NULL
hits$pdb.id <- c('1AKE_A','6S36_A','6RZE_A','3HPR_A','1E4V_A','5EJE_A','1E4Y_A','3X2S_A','6HAP_A','6HAM_A','4K46_A','3GMT_A','4PZL_A')
# Download related PDB files (save locally in a new folder called "pdbs")
files <- get.pdb(hits$pdb.id, path="pdbs", split=TRUE, gzip=TRUE)
# Align related PDBs
pdbs <- pdbaln(files, fit = TRUE, exefile="msa")
# Draw schematic alignment
plot(pdbs, labels=ids)
anno <- pdb.annotate(ids)
head(anno)
plot(pc.xray)
grps.rd <- cutree(hc.rd, k=3)
mktrj(pc.xray, file="pca_results.pdb")
