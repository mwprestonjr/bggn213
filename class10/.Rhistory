#candy = read.csv("candy-data.csv", row.names=1)
library(readr)
candy = read_csv("candy-data.csv")
# flextable allows for scrollable table in rendered doc
flextable::flextable(head(candy))
library(dplyr)
candy |> select(winpercent) |> sum()
library("skimr")
skim(candy)
library("ggplot2")
ggplot(candy, aes(x = winpercent)) +
geom_histogram(aes(y = after_stat(density))) +
geom_density()
mean(candy[candy$fruity==1,]$winpercent)
mean(candy[candy$chocolate==1,]$winpercent)
t.test(candy[candy$fruity==1,]$winpercent, candy[candy$chocolate==1,]$winpercent)
candy |> arrange(winpercent) |> head(5)
candy |> arrange(winpercent) |> tail(5)
ggplot(candy) +
aes(winpercent, reorder(competitorname, winpercent)) +
geom_col() +
ylab('Candy name') +
xlab('Win percentage')
my_cols=rep("black", nrow(candy))
my_cols[as.logical(candy$chocolate)] = "chocolate"
my_cols[as.logical(candy$bar)] = "brown"
my_cols[as.logical(candy$fruity)] = "pink"
ggplot(candy) +
aes(winpercent, reorder(competitorname, winpercent)) +
geom_col(fill=my_cols) +
ylab('Candy name') +
xlab('Win percentage')
temp <- arrange(candy[as.logical(candy$fruity),], winpercent)
temp$competitorname[nrow(temp)]
library(ggrepel)
# How about a plot of price vs win
ggplot(candy) +
aes(winpercent, pricepercent, label=candy$competitorname) +
geom_point(col=my_cols) +
geom_text_repel(col=my_cols, size=3.3, max.overlaps = 5)
ord <- order(candy$pricepercent, decreasing = TRUE)
head( candy[ord,], n=5 )
ggplot(candy) +
aes(pricepercent, reorder(competitorname, pricepercent)) +
geom_col() +
ylab('Candy name') +
xlab('Price percentage')
# Make a lollipop chart of pricepercent
ggplot(candy) +
aes(pricepercent, reorder(candy$competitorname, pricepercent)) +
geom_segment(aes(yend = reorder(candy$competitorname, pricepercent),
xend = 0), col=my_cols) +
geom_point()
library(corrplot)
# read in data and set column names
candy = read_csv("candy-data.csv")
candy <- as.data.frame(candy)
rownames(candy) <- candy[[1]]
candy <- candy[, -1]
candy
cij <- cor(candy)
corrplot(cij)
# Define plotting functions for PCA results
plot_pca_scatter12 <- function(pca){
# Plot "PC Plot" / "score plot" i.e. scatterplot of PC1 v. PC2
ggplot(pca$x) +
aes(x = PC1, y = PC2) +
geom_point()
}
plot_pca_scree <- function(pca){
# Create scree plot
# Compute variance explained
v <- round(pca$sdev^2/sum(pca$sdev^2) * 100)
variance_df <- data.frame(
PC = factor(paste0("PC", 1:length(v)), levels = paste0("PC", 1:length(v))),
Variance = v
)
# Plot
ggplot(variance_df) +
aes(x = PC, y = Variance) +
geom_col(fill = "steelblue") +
xlab("Principal component") +
ylab("Percent variation") +
theme_bw() +
theme(axis.text.x = element_text(angle = 0))
}
plot_pca_loading <- function(pca){
# plot PCA loadings
ggplot(pca$rotation) +
aes(x = PC1,
y = reorder(rownames(pca$rotation), PC1)) +
geom_col(fill = "steelblue") +
xlab("PC1 Loading Score") +
ylab("") +
theme_bw() +
theme(axis.text.y = element_text(size = 9))
}
plot_pca_results <- function(pca){
print(plot_pca_scatter12(pca))
print(plot_pca_scree(pca))
print(plot_pca_loading(pca))
}
# Perform PCA and show results
candy.pca <- prcomp(candy, scale=T)
summary(candy.pca)
plot_pca_results(candy.pca)
# repeat, plotting size based on winpercent
# Make a new data-frame with our PCA results and candy data
my_data <- cbind(candy, candy.pca$x[,1:3])
# plot
p <- ggplot(my_data) +
aes(x=PC1, y=PC2,
size=winpercent/100,
text=rownames(my_data),
label=rownames(my_data)) +
geom_point(col=my_cols)
p
library(dplyr)
temp <- candy |> arrange(winpercent) |> head(5)
temp$competitorname
temp <- candy |> arrange(winpercent) |> head(5)
temp
candy |> arrange(winpercent) |> head(5)
# read in data and set column names
candy = read_csv("candy-data.csv")
candy <- as.data.frame(candy)
rownames(candy) <- candy[[1]]
candy <- candy[, -1]
head(candy)
# read in data and set column names
candy = read_csv("candy-data.csv", show_col_types = FALSE)
candy <- as.data.frame(candy)
rownames(candy) <- candy[[1]]
candy <- candy[, -1]
head(candy)
round(candy["Kit Kat", ]$winpercent)
round(candy["Tootsie Roll Snack Bars", ]$winpercent)
round(candy["Kit Kat", ]$winpercent)
round(candy["Reese's Peanut Butter cup", ]$winpercent)
#candy = read.csv("candy-data.csv", row.names=1)
library(readr)
# read in data and set column names
candy = read_csv("candy-data.csv", show_col_types = FALSE)
candy <- as.data.frame(candy)
rownames(candy) <- candy[[1]]
candy <- candy[, -1]
head(candy)
# flextable allows for scrollable table in rendered doc
flextable::flextable(head(candy))
#candy = read.csv("candy-data.csv", row.names=1)
library(readr)
# read in data and set column names
candy = read_csv("candy-data.csv", show_col_types = FALSE)
candy <- as.data.frame(candy)
rownames(candy) <- candy[[1]]
candy <- candy[, -1]
head(candy)
# flextable allows for scrollable table in rendered doc
flextable::flextable(head(candy))
library(dplyr)
candy |> select(winpercent) |> sum()
round(candy["Reese's Peanut Butter cup", ]$winpercent)
round(candy["Kit Kat", ]$winpercent)
round(candy["Tootsie Roll Snack Bars", ]$winpercent)
library("skimr")
skim(candy)
library("ggplot2")
ggplot(candy, aes(x = winpercent)) +
geom_histogram(aes(y = after_stat(density))) +
geom_density()
mean(candy[candy$fruity==1,]$winpercent)
mean(candy[candy$chocolate==1,]$winpercent)
t.test(candy[candy$fruity==1,]$winpercent, candy[candy$chocolate==1,]$winpercent)
candy |> arrange(winpercent) |> head(5)
candy |> arrange(winpercent) |> tail(5)
ggplot(candy) +
aes(winpercent, reorder(competitorname, winpercent)) +
geom_col() +
ylab('Candy name') +
xlab('Win percentage')
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col() +
ylab('Candy name') +
xlab('Win percentage')
my_cols=rep("black", nrow(candy))
my_cols[as.logical(candy$chocolate)] = "chocolate"
my_cols[as.logical(candy$bar)] = "brown"
my_cols[as.logical(candy$fruity)] = "pink"
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col(fill=my_cols) +
ylab('Candy name') +
xlab('Win percentage')
arrange(candy[as.logical(candy$chocolate),], winpercent)$competitorname[1]
arrange(candy[as.logical(candy$chocolate),], winpercent)
rownames(arrange(candy[as.logical(candy$chocolate),], winpercent))
rownames(arrange(candy[as.logical(candy$chocolate),], winpercent))[1]
temp <- arrange(candy[as.logical(candy$fruity),], winpercent)
rownames(temp)[nrow(temp)]
temp <- arrange(candy[as.logical(candy$fruity),], winpercent)
rownames(temp)[nrow(temp)]
temp <- arrange(candy[as.logical(candy$fruity),], winpercent)
temp$competitorname[nrow(temp)]
library(ggrepel)
# How about a plot of price vs win
ggplot(candy) +
aes(winpercent, pricepercent, label=candy$competitorname) +
geom_point(col=my_cols) +
geom_text_repel(col=my_cols, size=3.3, max.overlaps = 5)
library(ggrepel)
# How about a plot of price vs win
ggplot(candy) +
aes(winpercent, pricepercent, label=rownames(candy)) +
geom_point(col=my_cols) +
geom_text_repel(col=my_cols, size=3.3, max.overlaps = 5)
ord <- order(candy$pricepercent, decreasing = TRUE)
head( candy[ord,], n=5 )
ggplot(candy) +
aes(pricepercent, reorder(rownames(candy), pricepercent)) +
geom_col() +
ylab('Candy name') +
xlab('Price percentage')
# Make a lollipop chart of pricepercent
ggplot(candy) +
aes(pricepercent, reorder(rownames(candy), pricepercent)) +
geom_segment(aes(yend = reorder(rownames(candy), pricepercent),
xend = 0), col=my_cols) +
geom_point()
cij <- cor(candy)
corrplot(cij)
# repeat, plotting size based on winpercent
# Make a new data-frame with our PCA results and candy data
my_data <- cbind(candy, candy.pca$x[,1:3])
# plot
p <- ggplot(my_data) +
aes(x=PC1, y=PC2,
size=winpercent/100,
text=rownames(my_data),
label=rownames(my_data)) +
geom_point(col=my_cols)
p
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 7)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 15)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 50)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 7)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
library(plotly)
install.packages("plotly")
library(plotly)
ggplotly(p)
library(plotly)
ggplotly(p)
# Perform PCA and show results
candy.pca <- prcomp(candy, scale=T)
summary(candy.pca)
plot_pca_results(candy.pca)
par(mar=c(8,4,2,2))
barplot(pca$rotation[,1], las=2, ylab="PC1 Contribution")
par(mar=c(8,4,2,2))
barplot(candy.pca$rotation[,1], las=2, ylab="PC1 Contribution")
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 20)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 30)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 40)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 50)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
#candy = read.csv("candy-data.csv", row.names=1)
library(readr)
# read in data and set column names
candy = read_csv("candy-data.csv", show_col_types = FALSE)
candy <- as.data.frame(candy)
rownames(candy) <- candy[[1]]
candy <- candy[, -1]
head(candy)
# flextable allows for scrollable table in rendered doc
flextable::flextable(head(candy))
library(dplyr)
candy |> select(winpercent) |> sum()
library("skimr")
skim(candy)
library("ggplot2")
ggplot(candy, aes(x = winpercent)) +
geom_histogram(aes(y = after_stat(density))) +
geom_density()
mean(candy[candy$fruity==1,]$winpercent)
mean(candy[candy$chocolate==1,]$winpercent)
t.test(candy[candy$fruity==1,]$winpercent, candy[candy$chocolate==1,]$winpercent)
candy |> arrange(winpercent) |> head(5)
candy |> arrange(winpercent) |> tail(5)
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col() +
ylab('Candy name') +
xlab('Win percentage')
my_cols=rep("black", nrow(candy))
my_cols[as.logical(candy$chocolate)] = "chocolate"
my_cols[as.logical(candy$bar)] = "brown"
my_cols[as.logical(candy$fruity)] = "pink"
ggplot(candy) +
aes(winpercent, reorder(rownames(candy), winpercent)) +
geom_col(fill=my_cols) +
ylab('Candy name') +
xlab('Win percentage')
temp <- arrange(candy[as.logical(candy$fruity),], winpercent)
rownames(temp)[nrow(temp)]
library(ggrepel)
# How about a plot of price vs win
ggplot(candy) +
aes(winpercent, pricepercent, label=rownames(candy)) +
geom_point(col=my_cols) +
geom_text_repel(col=my_cols, size=3.3, max.overlaps = 5)
ord <- order(candy$pricepercent, decreasing = TRUE)
head( candy[ord,], n=5 )
ggplot(candy) +
aes(pricepercent, reorder(rownames(candy), pricepercent)) +
geom_col() +
ylab('Candy name') +
xlab('Price percentage')
# Make a lollipop chart of pricepercent
ggplot(candy) +
aes(pricepercent, reorder(rownames(candy), pricepercent)) +
geom_segment(aes(yend = reorder(rownames(candy), pricepercent),
xend = 0), col=my_cols) +
geom_point()
library(corrplot)
cij <- cor(candy)
corrplot(cij)
# Define plotting functions for PCA results
plot_pca_scatter12 <- function(pca){
# Plot "PC Plot" / "score plot" i.e. scatterplot of PC1 v. PC2
ggplot(pca$x) +
aes(x = PC1, y = PC2) +
geom_point()
}
plot_pca_scree <- function(pca){
# Create scree plot
# Compute variance explained
v <- round(pca$sdev^2/sum(pca$sdev^2) * 100)
variance_df <- data.frame(
PC = factor(paste0("PC", 1:length(v)), levels = paste0("PC", 1:length(v))),
Variance = v
)
# Plot
ggplot(variance_df) +
aes(x = PC, y = Variance) +
geom_col(fill = "steelblue") +
xlab("Principal component") +
ylab("Percent variation") +
theme_bw() +
theme(axis.text.x = element_text(angle = 0))
}
plot_pca_loading <- function(pca){
# plot PCA loadings
ggplot(pca$rotation) +
aes(x = PC1,
y = reorder(rownames(pca$rotation), PC1)) +
geom_col(fill = "steelblue") +
xlab("PC1 Loading Score") +
ylab("") +
theme_bw() +
theme(axis.text.y = element_text(size = 9))
}
plot_pca_results <- function(pca){
print(plot_pca_scatter12(pca))
print(plot_pca_scree(pca))
print(plot_pca_loading(pca))
}
# Perform PCA and show results
candy.pca <- prcomp(candy, scale=T)
summary(candy.pca)
plot_pca_results(candy.pca)
# repeat, plotting size based on winpercent
# Make a new data-frame with our PCA results and candy data
my_data <- cbind(candy, candy.pca$x[,1:3])
# plot
p <- ggplot(my_data) +
aes(x=PC1, y=PC2,
size=winpercent/100,
text=rownames(my_data),
label=rownames(my_data)) +
geom_point(col=my_cols)
p
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 50)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
library(plotly)
ggplotly(p)
par(mar=c(8,4,2,2))
barplot(candy.pca$rotation[,1], las=2, ylab="PC1 Contribution")
# Make a lollipop chart of pricepercent
ggplot(candy) +
aes(pricepercent, reorder(rownames(candy), pricepercent)) +
geom_segment(aes(yend = reorder(rownames(candy), pricepercent),
xend = 0), col=my_cols) +
geom_point()
ggplot(candy) +
aes(pricepercent, reorder(rownames(candy), pricepercent)) +
geom_col() +
ylab('Candy name') +
xlab('Price percentage')
library(ggrepel)
# How about a plot of price vs win
ggplot(candy) +
aes(winpercent, pricepercent, label=rownames(candy)) +
geom_point(col=my_cols) +
geom_text_repel(col=my_cols, size=3.3, max.overlaps = 5)
library(ggrepel)
# How about a plot of price vs win
ggplot(candy) +
aes(winpercent, pricepercent, label=rownames(candy)) +
geom_point(col=my_cols) +
geom_text_repel(col=my_cols, size=3.3, max.overlaps = 20)
library(ggrepel)
# How about a plot of price vs win
ggplot(candy) +
aes(winpercent, pricepercent, label=rownames(candy)) +
geom_point(col=my_cols) +
geom_text_repel(col=my_cols, size=3.3, max.overlaps = 10)
library(ggrepel)
# How about a plot of price vs win
ggplot(candy) +
aes(winpercent, pricepercent, label=rownames(candy)) +
geom_point(col=my_cols) +
geom_text_repel(col=my_cols, size=3.3, max.overlaps = 15)
library(ggrepel)
# How about a plot of price vs win
ggplot(candy) +
aes(winpercent, pricepercent, label=rownames(candy)) +
geom_point(col=my_cols) +
geom_text_repel(col=my_cols, size=3.3, max.overlaps = 20)
cij <- cor(candy)
corrplot(cij)
cij <- cor(candy)
corrplot(cij)
# repeat, plotting size based on winpercent
# Make a new data-frame with our PCA results and candy data
my_data <- cbind(candy, candy.pca$x[,1:3])
# plot
p <- ggplot(my_data) +
aes(x=PC1, y=PC2,
size=winpercent/100,
text=rownames(my_data),
label=rownames(my_data)) +
geom_point(col=my_cols)
p
# repeat, plotting size based on winpercent
# Make a new data-frame with our PCA results and candy data
my_data <- cbind(candy, candy.pca$x[,1:3])
# plot
p <- ggplot(my_data) +
aes(x=PC1, y=PC2,
size=winpercent/100,
text=rownames(my_data),
label=rownames(my_data)) +
geom_point(col=my_cols)
p
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 50)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 30)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 20)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 30)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
library(plotly)
ggplotly(p)
library(plotly)
ggplotly(p)
