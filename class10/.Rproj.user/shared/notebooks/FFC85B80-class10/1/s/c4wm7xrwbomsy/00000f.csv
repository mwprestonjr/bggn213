"0","# Define plotting functions for PCA results"
"0",""
"0","plot_pca_scatter12 <- function(pca){"
"0","  # Plot ""PC Plot"" / ""score plot"" i.e. scatterplot of PC1 v. PC2"
"0","  ggplot(pca$x) +"
"0","    aes(x = PC1, y = PC2) +"
"0","    geom_point()"
"0","}"
"0",""
"0","plot_pca_scree <- function(pca){"
"0","  # Create scree plot"
"0",""
"0","  # Compute variance explained"
"0","  v <- round(pca$sdev^2/sum(pca$sdev^2) * 100)"
"0","  variance_df <- data.frame("
"0","    PC = factor(paste0(""PC"", 1:length(v)), levels = paste0(""PC"", 1:length(v))),"
"0","    Variance = v"
"0","  )"
"0","  "
"0","  # Plot"
"0","  ggplot(variance_df) +"
"0","  aes(x = PC, y = Variance) +"
"0","  geom_col(fill = ""steelblue"") +"
"0","  xlab(""Principal component"") +"
"0","  ylab(""Percent variation"") +"
"0","  theme_bw() +"
"0","  theme(axis.text.x = element_text(angle = 0))"
"0","}"
"0",""
"0","plot_pca_loading <- function(pca){"
"0","  # plot PCA loadings"
"0","  ggplot(pca$rotation) +"
"0","  aes(x = PC1,"
"0","  y = reorder(rownames(pca$rotation), PC1)) +"
"0","  geom_col(fill = ""steelblue"") +"
"0","  xlab(""PC1 Loading Score"") +"
"0","  ylab("""") +"
"0","  theme_bw() +"
"0","  theme(axis.text.y = element_text(size = 9))"
"0","}"
"0",""
"0","plot_pca_results <- function(pca){"
"0","  print(plot_pca_scatter12(pca))"
"0","  print(plot_pca_scree(pca))"
"0","  print(plot_pca_loading(pca))"
"0","}"
"0",""
